============================= test session starts =============================
platform win32 -- Python 3.12.10, pytest-9.0.1, pluggy-1.6.0 -- C:\Users\acer\AppData\Local\Programs\Python\Python312\python.exe
cachedir: .pytest_cache
django: version: 5.2.6, settings: config.settings (from ini)
rootdir: C:\proyectos\IPES6\backend
configfile: pytest.ini
plugins: django-4.11.1
collecting ... collected 4 items

apps/alumnos/tests/test_validaciones_aprobacion.py::test_estudiante_tiene_materia_aprobada FAILED [ 25%]
apps/alumnos/tests/test_validaciones_aprobacion.py::test_crear_planilla_regularidad_prevent_duplicate ERROR [ 50%]
apps/alumnos/tests/test_validaciones_aprobacion.py::test_crear_acta_examen_prevent_duplicate ERROR [ 75%]
apps/alumnos/tests/test_validaciones_aprobacion.py::test_registrar_disposicion_equivalencia_prevent_duplicate FAILED [100%]

=================================== ERRORS ====================================
_____ ERROR at setup of test_crear_planilla_regularidad_prevent_duplicate _____
file C:\proyectos\IPES6\backend\apps\alumnos\tests\test_validaciones_aprobacion.py, line 46
  @pytest.mark.django_db
  def test_crear_planilla_regularidad_prevent_duplicate(mocker):
E       fixture 'mocker' not found
>       available fixtures: _dj_autoclear_mailbox, _django_clear_site_cache, _django_db_helper, _django_db_marker, _django_set_urlconf, _django_setup_unittest, _fail_for_invalid_template_variable, _live_server_helper, _template_string_if_invalid_marker, admin_client, admin_user, async_client, async_rf, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, capteesys, client, db, django_assert_max_num_queries, django_assert_num_queries, django_capture_on_commit_callbacks, django_db_blocker, django_db_createdb, django_db_keepdb, django_db_modify_db_settings, django_db_modify_db_settings_parallel_suffix, django_db_modify_db_settings_tox_suffix, django_db_modify_db_settings_xdist_suffix, django_db_reset_sequences, django_db_serialized_rollback, django_db_setup, django_db_use_migrations, django_mail_dnsname, django_mail_patch_dns, django_test_environment, django_user_model, django_username_field, doctest_namespace, live_server, mailoutbox, monkeypatch, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, rf, settings, subtests, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, transactional_db
>       use 'pytest --fixtures [testpath]' for help on them.

C:\proyectos\IPES6\backend\apps\alumnos\tests\test_validaciones_aprobacion.py:46
_________ ERROR at setup of test_crear_acta_examen_prevent_duplicate __________
file C:\proyectos\IPES6\backend\apps\alumnos\tests\test_validaciones_aprobacion.py, line 88
  @pytest.mark.django_db
  def test_crear_acta_examen_prevent_duplicate(mocker):
E       fixture 'mocker' not found
>       available fixtures: _dj_autoclear_mailbox, _django_clear_site_cache, _django_db_helper, _django_db_marker, _django_set_urlconf, _django_setup_unittest, _fail_for_invalid_template_variable, _live_server_helper, _template_string_if_invalid_marker, admin_client, admin_user, async_client, async_rf, cache, capfd, capfdbinary, caplog, capsys, capsysbinary, capteesys, client, db, django_assert_max_num_queries, django_assert_num_queries, django_capture_on_commit_callbacks, django_db_blocker, django_db_createdb, django_db_keepdb, django_db_modify_db_settings, django_db_modify_db_settings_parallel_suffix, django_db_modify_db_settings_tox_suffix, django_db_modify_db_settings_xdist_suffix, django_db_reset_sequences, django_db_serialized_rollback, django_db_setup, django_db_use_migrations, django_mail_dnsname, django_mail_patch_dns, django_test_environment, django_user_model, django_username_field, doctest_namespace, live_server, mailoutbox, monkeypatch, pytestconfig, record_property, record_testsuite_property, record_xml_attribute, recwarn, rf, settings, subtests, tmp_path, tmp_path_factory, tmpdir, tmpdir_factory, transactional_db
>       use 'pytest --fixtures [testpath]' for help on them.

C:\proyectos\IPES6\backend\apps\alumnos\tests\test_validaciones_aprobacion.py:88
================================== FAILURES ===================================
___________________ test_estudiante_tiene_materia_aprobada ____________________

    @pytest.mark.django_db
    def test_estudiante_tiene_materia_aprobada():
        user = User.objects.create(username="testuser")
>       estudiante = Estudiante.objects.create(dni="12345678", apellido_nombre="Test Student", user=user)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

apps\alumnos\tests\test_validaciones_aprobacion.py:16: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\acer\AppData\Local\Programs\Python\Python312\Lib\site-packages\django\db\models\manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
C:\Users\acer\AppData\Local\Programs\Python\Python312\Lib\site-packages\django\db\models\query.py:661: in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <Estudiante:  (DNI: 12345678)>, args = ()
kwargs = {'apellido_nombre': 'Test Student'}
cls = <class 'core.models.Estudiante'>, opts = <Options for Estudiante>
_setattr = <built-in function setattr>, _DEFERRED = <Deferred field>
fields_iter = <tuple_iterator object at 0x00000212A73D3850>, val = {}
field = <django.db.models.fields.json.JSONField: datos_extra>
is_related_object = False, rel_obj = <User: testuser>
property_names = frozenset({'pk'})

    def __init__(self, *args, **kwargs):
        # Alias some things as locals to avoid repeat global lookups
        cls = self.__class__
        opts = self._meta
        _setattr = setattr
        _DEFERRED = DEFERRED
        if opts.abstract:
            raise TypeError("Abstract models cannot be instantiated.")
    
        pre_init.send(sender=cls, args=args, kwargs=kwargs)
    
        # Set up the storage for instance state
        self._state = ModelState()
    
        # There is a rather weird disparity here; if kwargs, it's set, then args
        # overrides it. It should be one or the other; don't duplicate the work
        # The reason for the kwargs check is that standard iterator passes in by
        # args, and instantiation for iteration is 33% faster.
        if len(args) > len(opts.concrete_fields):
            # Daft, but matches old exception sans the err msg.
            raise IndexError("Number of args exceeds number of fields")
    
        if not kwargs:
            fields_iter = iter(opts.concrete_fields)
            # The ordering of the zip calls matter - zip throws StopIteration
            # when an iter throws it. So if the first iter throws it, the second
            # is *not* consumed. We rely on this, so don't change the order
            # without changing the logic.
            for val, field in zip(args, fields_iter):
                if val is _DEFERRED:
                    continue
                _setattr(self, field.attname, val)
        else:
            # Slower, kwargs-ready version.
            fields_iter = iter(opts.fields)
            for val, field in zip(args, fields_iter):
                if val is _DEFERRED:
                    continue
                _setattr(self, field.attname, val)
                if kwargs.pop(field.name, NOT_PROVIDED) is not NOT_PROVIDED:
                    raise TypeError(
                        f"{cls.__qualname__}() got both positional and "
                        f"keyword arguments for field '{field.name}'."
                    )
    
        # Now we're left with the unprocessed fields that *must* come from
        # keywords, or default.
    
        for field in fields_iter:
            is_related_object = False
            # Virtual field
            if field.column is None or field.generated:
                continue
            if kwargs:
                if isinstance(field.remote_field, ForeignObjectRel):
                    try:
                        # Assume object instance was passed in.
                        rel_obj = kwargs.pop(field.name)
                        is_related_object = True
                    except KeyError:
                        try:
                            # Object instance wasn't passed in -- must be an ID.
                            val = kwargs.pop(field.attname)
                        except KeyError:
                            val = field.get_default()
                else:
                    try:
                        val = kwargs.pop(field.attname)
                    except KeyError:
                        # This is done with an exception rather than the
                        # default argument on pop because we don't want
                        # get_default() to be evaluated, and then not used.
                        # Refs #12057.
                        val = field.get_default()
            else:
                val = field.get_default()
    
            if is_related_object:
                # If we are passed a related instance, set it using the
                # field.name instead of field.attname (e.g. "user" instead of
                # "user_id") so that the object gets properly cached (and type
                # checked) by the RelatedObjectDescriptor.
                if rel_obj is not _DEFERRED:
                    _setattr(self, field.name, rel_obj)
            else:
                if val is not _DEFERRED:
                    _setattr(self, field.attname, val)
    
        if kwargs:
            property_names = opts._property_names
            unexpected = ()
            for prop, value in kwargs.items():
                # Any remaining kwargs must correspond to properties or virtual
                # fields.
                if prop in property_names:
                    if value is not _DEFERRED:
                        _setattr(self, prop, value)
                else:
                    try:
                        opts.get_field(prop)
                    except FieldDoesNotExist:
                        unexpected += (prop,)
                    else:
                        if value is not _DEFERRED:
                            _setattr(self, prop, value)
            if unexpected:
                unexpected_names = ", ".join(repr(n) for n in unexpected)
>               raise TypeError(
                    f"{cls.__name__}() got unexpected keyword arguments: "
                    f"{unexpected_names}"
                )
E               TypeError: Estudiante() got unexpected keyword arguments: 'apellido_nombre'

C:\Users\acer\AppData\Local\Programs\Python\Python312\Lib\site-packages\django\db\models\base.py:569: TypeError
---------------------------- Captured stdout setup ----------------------------
Operations to perform:
  Synchronize unmigrated apps: alumnos, carreras, corsheaders, guias, messages, rest_framework, rest_framework_simplejwt, staticfiles
  Apply all migrations: admin, asistencia, auth, contenttypes, core, preinscriptions, sessions
Synchronizing apps without migrations:
  Creating tables...
    Running deferred SQL...
Running migrations:
  Applying contenttypes.0001_initial... OK
  Applying auth.0001_initial... OK
  Applying admin.0001_initial... OK
  Applying admin.0002_logentry_remove_auto_add... OK
  Applying admin.0003_logentry_add_action_flag_choices... OK
  Applying core.0001_initial... OK
  Applying core.0002_profesorado_inscripcion_abierta... OK
  Applying core.0003_corealumno_corepreinscripcion_and_more... OK
  Applying core.0004_alter_profesorado_table... OK
  Applying core.0005_alter_materia_options_alter_profesorado_options_and_more... OK
  Applying core.0006_remove_materia_docente_titular_docente_dni_and_more... OK
  Applying core.0007_turno_remove_materia_carga_horaria_semanal_and_more... OK
  Applying core.0008_preinscripcion_delete_corealumno_and_more... OK
  Applying core.0009_alter_estudiante_legajo... OK
  Applying core.0010_ventanahabilitacion... OK
  Applying core.0011_alter_ventanahabilitacion_tipo... OK
  Applying core.0012_equivalenciacurricular_mesaexamen_pedidoanalitico_and_more... OK
  Applying core.0013_add_preinscripcion_checklist... OK
  Applying core.0014_add_inscripcion_materia_alumno... OK
  Applying core.0015_add_preinscripcion_datos_extra... OK
  Applying core.0016_remove_preinscripcion_datos_extra_and_more... OK
  Applying core.0017_preinscripcion_datos_extra... OK
  Applying core.0018_preinscripcion_activa_and_more... OK
  Applying core.0019_preinscripcion_cuil... OK
  Applying core.0020_remove_preinscripcion_foto_4x4_dataurl... OK
  Applying core.0021_inscripcionmateriaalumno_estado_and_more... OK
  Applying core.0022_regularidad_asistencia_porcentaje_and_more... OK
  Applying core.0023_ventanahabilitacion_periodo... OK
  Applying core.0024_estudiante_must_change_password... OK
  Applying core.0025_staffasignacion... OK
  Applying core.0026_alter_staffasignacion_options... OK
  Applying core.0027_mesaexamen_modalidad_and_more... OK
  Applying core.0028_messagetopic_conversation_conversationaudit_message_and_more... OK
  Applying core.0029_alter_staffasignacion_rol... OK
  Applying core.0030_materia_tipo_formacion... OK
  Applying core.0031_estudiante_datos_extra... OK
  Applying core.0032_preinscripcionchecklist_curso_introductorio... OK
  Applying contenttypes.0002_remove_content_type_name... OK
  Applying auth.0002_alter_permission_name_max_length... OK
  Applying auth.0003_alter_user_email_max_length... OK
  Applying auth.0004_alter_user_username_opts... OK
  Applying auth.0005_alter_user_last_login_null... OK
  Applying auth.0006_require_contenttypes_0002... OK
  Applying auth.0007_alter_validators_add_error_messages... OK
  Applying auth.0008_alter_user_username_max_length... OK
  Applying auth.0009_alter_user_last_name_max_length... OK
  Applying auth.0010_alter_group_name_max_length... OK
  Applying auth.0011_update_proxy_permissions... OK
  Applying auth.0012_alter_user_first_name_max_length... OK
  Applying core.0033_planillas_regularidad... OK
  Applying core.0034_acta_examen... OK
  Applying core.0035_rename_core_planil_profeso_e43bd0_idx_core_planil_profeso_3a564c_idx_and_more... OK
  Applying core.0036_alter_ventanahabilitacion_tipo... OK
  Applying core.0037_requisitodocumentaciontemplate_and_more... OK
  Applying core.0038_correlatividadversion_estudiantecarrera_and_more... OK
  Applying asistencia.0001_initial... OK
  Applying asistencia.0002_asistenciadocente_alertas_docentemarcacionlog... OK
  Applying asistencia.0003_calendarioasistenciaevento_and_more... OK
  Applying asistencia.0004_calendarioasistenciaevento_comision_and_more... OK
  Applying asistencia.0005_alter_justificaciondetalle_constraints... OK
  Applying core.0039_correlatividadversion_vigencia_desde_and_more... OK
  Applying core.0040_alter_preinscripcion_cuil... OK
  Applying core.0041_alter_ventanahabilitacion_tipo... OK
  Applying core.0042_pedidoequivalencia_pedidoequivalenciamateria... OK
  Applying core.0043_mesaexamen_codigo_mesaexamen_docente_presidente_and_more... OK
  Applying core.0044_alter_staffasignacion_rol_and_more... OK
  Applying core.0045_estudiante_curso_introductorio_aprobado... OK
  Applying core.0046_alter_ventanahabilitacion_tipo... OK
  Applying core.0047_auditlog... OK
  Applying core.0048_auditlog_audit_log_request_a46c86_idx... OK
  Applying core.0049_pedido_equivalencia_materia_nota... OK
  Applying core.0050_equivalencia_disposiciones... OK
  Applying core.0051_preinscripcionchecklist_incumbencia... OK
  Applying core.0052_profesorado_es_certificacion_docente... OK
  Applying core.0053_mesaactaoral... OK
  Applying core.0054_equivalencias_workflow... OK
  Applying core.0055_create_default_turnos... OK
  Applying core.0056_regularidad_planilla_lock... OK
  Applying preinscriptions.0001_initial... OK
  Applying preinscriptions.0002_remove_alumnolaboral_alumno_and_more... OK
  Applying preinscriptions.0003_initial... OK
  Applying sessions.0001_initial... OK
---------------------------- Captured stderr setup ----------------------------
Creating test database for alias 'default' ('test_ipes1_prueba')...

__________ test_registrar_disposicion_equivalencia_prevent_duplicate __________

    @pytest.mark.django_db
    def test_registrar_disposicion_equivalencia_prevent_duplicate():
        user = User.objects.create(username="admin")
>       estudiante = Estudiante.objects.create(dni="33333333", apellido_nombre="Student 3", user=user)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

apps\alumnos\tests\test_validaciones_aprobacion.py:130: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\acer\AppData\Local\Programs\Python\Python312\Lib\site-packages\django\db\models\manager.py:87: in manager_method
    return getattr(self.get_queryset(), name)(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
C:\Users\acer\AppData\Local\Programs\Python\Python312\Lib\site-packages\django\db\models\query.py:661: in create
    obj = self.model(**kwargs)
          ^^^^^^^^^^^^^^^^^^^^
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <Estudiante:  (DNI: 33333333)>, args = ()
kwargs = {'apellido_nombre': 'Student 3'}
cls = <class 'core.models.Estudiante'>, opts = <Options for Estudiante>
_setattr = <built-in function setattr>, _DEFERRED = <Deferred field>
fields_iter = <tuple_iterator object at 0x00000212A73D1C00>, val = {}
field = <django.db.models.fields.json.JSONField: datos_extra>
is_related_object = False, rel_obj = <User: admin>
property_names = frozenset({'pk'})

    def __init__(self, *args, **kwargs):
        # Alias some things as locals to avoid repeat global lookups
        cls = self.__class__
        opts = self._meta
        _setattr = setattr
        _DEFERRED = DEFERRED
        if opts.abstract:
            raise TypeError("Abstract models cannot be instantiated.")
    
        pre_init.send(sender=cls, args=args, kwargs=kwargs)
    
        # Set up the storage for instance state
        self._state = ModelState()
    
        # There is a rather weird disparity here; if kwargs, it's set, then args
        # overrides it. It should be one or the other; don't duplicate the work
        # The reason for the kwargs check is that standard iterator passes in by
        # args, and instantiation for iteration is 33% faster.
        if len(args) > len(opts.concrete_fields):
            # Daft, but matches old exception sans the err msg.
            raise IndexError("Number of args exceeds number of fields")
    
        if not kwargs:
            fields_iter = iter(opts.concrete_fields)
            # The ordering of the zip calls matter - zip throws StopIteration
            # when an iter throws it. So if the first iter throws it, the second
            # is *not* consumed. We rely on this, so don't change the order
            # without changing the logic.
            for val, field in zip(args, fields_iter):
                if val is _DEFERRED:
                    continue
                _setattr(self, field.attname, val)
        else:
            # Slower, kwargs-ready version.
            fields_iter = iter(opts.fields)
            for val, field in zip(args, fields_iter):
                if val is _DEFERRED:
                    continue
                _setattr(self, field.attname, val)
                if kwargs.pop(field.name, NOT_PROVIDED) is not NOT_PROVIDED:
                    raise TypeError(
                        f"{cls.__qualname__}() got both positional and "
                        f"keyword arguments for field '{field.name}'."
                    )
    
        # Now we're left with the unprocessed fields that *must* come from
        # keywords, or default.
    
        for field in fields_iter:
            is_related_object = False
            # Virtual field
            if field.column is None or field.generated:
                continue
            if kwargs:
                if isinstance(field.remote_field, ForeignObjectRel):
                    try:
                        # Assume object instance was passed in.
                        rel_obj = kwargs.pop(field.name)
                        is_related_object = True
                    except KeyError:
                        try:
                            # Object instance wasn't passed in -- must be an ID.
                            val = kwargs.pop(field.attname)
                        except KeyError:
                            val = field.get_default()
                else:
                    try:
                        val = kwargs.pop(field.attname)
                    except KeyError:
                        # This is done with an exception rather than the
                        # default argument on pop because we don't want
                        # get_default() to be evaluated, and then not used.
                        # Refs #12057.
                        val = field.get_default()
            else:
                val = field.get_default()
    
            if is_related_object:
                # If we are passed a related instance, set it using the
                # field.name instead of field.attname (e.g. "user" instead of
                # "user_id") so that the object gets properly cached (and type
                # checked) by the RelatedObjectDescriptor.
                if rel_obj is not _DEFERRED:
                    _setattr(self, field.name, rel_obj)
            else:
                if val is not _DEFERRED:
                    _setattr(self, field.attname, val)
    
        if kwargs:
            property_names = opts._property_names
            unexpected = ()
            for prop, value in kwargs.items():
                # Any remaining kwargs must correspond to properties or virtual
                # fields.
                if prop in property_names:
                    if value is not _DEFERRED:
                        _setattr(self, prop, value)
                else:
                    try:
                        opts.get_field(prop)
                    except FieldDoesNotExist:
                        unexpected += (prop,)
                    else:
                        if value is not _DEFERRED:
                            _setattr(self, prop, value)
            if unexpected:
                unexpected_names = ", ".join(repr(n) for n in unexpected)
>               raise TypeError(
                    f"{cls.__name__}() got unexpected keyword arguments: "
                    f"{unexpected_names}"
                )
E               TypeError: Estudiante() got unexpected keyword arguments: 'apellido_nombre'

C:\Users\acer\AppData\Local\Programs\Python\Python312\Lib\site-packages\django\db\models\base.py:569: TypeError
-------------------------- Captured stderr teardown ---------------------------
Destroying test database for alias 'default' ('test_ipes1_prueba')...

============================== warnings summary ===============================
..\..\..\Users\acer\AppData\Local\Programs\Python\Python312\Lib\site-packages\pydantic\_internal\_config.py:323
..\..\..\Users\acer\AppData\Local\Programs\Python\Python312\Lib\site-packages\pydantic\_internal\_config.py:323
..\..\..\Users\acer\AppData\Local\Programs\Python\Python312\Lib\site-packages\pydantic\_internal\_config.py:323
  C:\Users\acer\AppData\Local\Programs\Python\Python312\Lib\site-packages\pydantic\_internal\_config.py:323: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.11/migration/
    warnings.warn(DEPRECATION_MESSAGE, DeprecationWarning)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ===========================
FAILED apps/alumnos/tests/test_validaciones_aprobacion.py::test_estudiante_tiene_materia_aprobada - TypeError: Estudiante() got unexpected keyword arguments: 'apellido_nombre'
FAILED apps/alumnos/tests/test_validaciones_aprobacion.py::test_registrar_disposicion_equivalencia_prevent_duplicate - TypeError: Estudiante() got unexpected keyword arguments: 'apellido_nombre'
ERROR apps/alumnos/tests/test_validaciones_aprobacion.py::test_crear_planilla_regularidad_prevent_duplicate
ERROR apps/alumnos/tests/test_validaciones_aprobacion.py::test_crear_acta_examen_prevent_duplicate
================== 2 failed, 3 warnings, 2 errors in 33.20s ===================
