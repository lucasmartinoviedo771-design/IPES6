<Typography variant="h5" fontWeight={800}>
        Cargar Materias — {profesorado?.nombre || (isLoadingProfesorado ? '...': '')}
        {planDeEstudio ? ` · ${planDeEstudio.resolucion}` : (isLoadingPlanDeEstudio ? '' : '')}
      </Typography>

      <Paper sx={{ p: 2, mb: 2 }}>
        <Typography variant="h6" mb={2}>Filtros</Typography>
        <Stack direction="row" spacing={2} mb={2} alignItems="center">
          <TextField
            size="small"
            label="Nombre de Materia"
            value={filterNombre}
            onChange={(e) => setFilterNombre(e.target.value)}
            sx={{ width: 200 }}
          />
          <FormControl size="small" sx={{ width: 120 }} disabled={isLoadingProfesorado}>
            <InputLabel>Año</InputLabel>
            <Select
              value={filterAnio}
              label="Año"
              onChange={(e) => setFilterAnio(e.target.value as number | '')}
            >
              <MenuItem value="">Todos</MenuItem>
              {profesorado?.duracion_anios && Array.from({ length: profesorado.duracion_anios }, (_, i) => i + 1).map(year => (
                <MenuItem key={year} value={year}>{year}° Año</MenuItem>
              ))}
            </Select>
          </FormControl>
          <FormControl size="small" sx={{ width: 150 }}>
            <InputLabel>Formato</InputLabel>
            <Select
              value={filterFormato}
              label="Formato"
              onChange={(e) => setFilterFormato(e.target.value)}
            >
              <MenuItem value="">Todos</MenuItem>
              {FORMATO_CHOICES.map((option) => (
                <MenuItem key={option.value} value={option.value}>
                  {option.label}
                </MenuItem>
              ))}
            </Select>
          </FormControl>
          <FormControl size="small" sx={{ width: 150 }}>
            <InputLabel>Cursada</InputLabel>
            <Select
              value={filterRegimen}
              label="Cursada"
              onChange={(e) => setFilterRegimen(e.target.value)}
            >
              <MenuItem value="">Todos</MenuItem>
              {TIPO_CURSADA_CHOICES.map((option) => (
                <MenuItem key={option.value} value={option.value}>
                  {option.label}
                </MenuItem>
              ))}
            </Select>
          </FormControl>
          <Button variant="outlined" onClick={handleClearFilters}>Limpiar Filtros</Button>
        </Stack>
      </Paper>

      <Paper sx={{ p: 2 }}>
        <Typography variant="h6" mb={2}>
          {editingMateria ? "Editar Materia" : "Crear Nueva Materia"}
        </Typography>
        <Box
          component="form"
          onSubmit={handleSubmit(onSubmit)}
          sx={{ display: "flex", flexDirection: "column", gap: 2 }}
        >
          <Controller
            name="anio_cursada"
            control={control}
            rules={{
              required: "El año de cursada es obligatorio",
              min: { value: 1, message: "Debe ser al menos 1" },
            }}
            render={({ field }) => (
              <TextField